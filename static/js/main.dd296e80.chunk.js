(this.webpackJsonpscampoleria=this.webpackJsonpscampoleria||[]).push([[0],{21:function(e,t,a){e.exports=a(33)},27:function(e,t,a){},33:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(19),o=a.n(r),c=(a(27),a(10)),s=a(3);const i=a(35).a.create({baseURL:"http://localhost:8081",headers:{"Content-Type":"application/json"}});i.interceptors.request.use(e=>{const t=JSON.parse(localStorage.getItem("scampoUser")),a=null===t||void 0===t?void 0:t.token;return a&&(e.headers.Authorization="Bearer "+a),e},e=>Promise.reject(e));var m=async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};try{return(await i({method:e,url:t,data:a,headers:n})).data}catch(l){return console.error("API Error:",l),403!==l.status&&401!==l.status||(window.location="/auth"),{error:!0,status:l.status,message:l.message}}};i.interceptors.response.use(e=>e,e=>(e.response&&400===e.response.status&&console.error("Bad request:",e),e.response&&403===e.response.status&&(console.log("Unauthorized access, redirecting..."),window.location="/auth"),e.response&&404===e.response.status&&console.log("Url not exist"),e.response&&500===e.response.status&&console.log("Server error"),Promise.reject(e)));var u="/get-products",d="/add-product",p="/edit-product",g="/delete-product",y="/getProduct?productId=",E={login:"/login",signIn:"/signUp",logout:"logout"};var v=()=>{const[e,t]=Object(n.useState)(null),[a,r]=Object(n.useState)(!1),[o,c]=Object(n.useState)(!1),[s,i]=Object(n.useState)(null),[u,p]=Object(n.useState)(null),[g,y]=Object(n.useState)(null),E=()=>!(s&&u&&g);return console.log("",e,a,o),l.a.createElement("div",{style:{width:"100%",display:"flex",justifyContent:"center",margin:"2rem"}},l.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"30rem"}},l.a.createElement("input",{onChange:e=>i(e.target.value),style:{margin:"1rem 0",padding:"1rem"},name:"title",placeholder:"Insert title",type:"text"}),l.a.createElement("input",{onChange:e=>p(e.target.value),style:{margin:"1rem 0",padding:"1rem"},name:"price",placeholder:"Insert price",type:"number"}),l.a.createElement("input",{onChange:e=>y(e.target.value),style:{margin:"1rem 0",padding:"1rem"},type:"number",name:"quantity",placeholder:"Insert quantity"}),l.a.createElement("button",{disabled:E(),onClick:async()=>{try{const e=await m("POST",d,{title:s,price:u,quantity:g});t(e)}catch(e){console.log(e),r(e.message)}finally{c(!1)}},style:{opacity:E()?.8:null,margin:"1rem",padding:"1rem"}},"Add product")))};var h=()=>{const[e,t]=Object(n.useState)(null),[a,r]=Object(n.useState)(!1),[o,c]=Object(n.useState)(!1),i=Object(s.r)(),d=Object(n.useCallback)(async()=>{try{const e=await m("GET",u);console.log(e),t(e)}catch(e){console.log(e),r(e.message)}finally{c(!1)}},[]);Object(n.useEffect)(()=>{d()},[d]);return console.log(a),l.a.createElement(l.a.Fragment,null,o?l.a.createElement("h5",null,"Products are loading..."):null,e&&l.a.createElement("div",{style:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",margin:"2rem"}},l.a.createElement("ul",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center"}},null===e||void 0===e?void 0:e.map(e=>l.a.createElement("li",{style:{listStyle:"none"},className:"productCard",key:e.id},l.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",width:"100%"}},l.a.createElement("button",{onClick:()=>{return t=e.id,void i("/edit-product/"+t);var t}},"EDIT"),l.a.createElement("button",{onClick:()=>(async e=>{try{await m("GET",`${g}?id=${e}`),d()}catch(t){console.log(t),r(t.message)}finally{c(!1)}})(e.id)},"REMOVE")),l.a.createElement("div",{className:"dataContainer"},l.a.createElement("div",null,l.a.createElement("span",null,"Title:")," ",l.a.createElement("span",null,null===e||void 0===e?void 0:e.title)),l.a.createElement("div",null,l.a.createElement("span",null,"Price:")," ",l.a.createElement("span",null,null===e||void 0===e?void 0:e.price)),l.a.createElement("div",null,l.a.createElement("span",null,"Quantity:")," ",l.a.createElement("span",null,null===e||void 0===e?void 0:e.quantity))))))))};var b=()=>{const[e,t]=Object(n.useState)(!1),[a,r]=Object(n.useState)(!1),[o,c]=Object(n.useState)(null),[i,u]=Object(n.useState)(null),[d,g]=Object(n.useState)(null),E=Object(s.t)();Object(n.useEffect)(()=>{(async()=>{try{const e=await m("GET",`${y}${E.id}`);e&&(c(e.title),u(e.price),g(e.quantity))}catch(e){console.log(e),t(e.message)}finally{r(!1)}})()},[E]),console.log(e,a);const v=()=>!(o&&i&&d);return l.a.createElement("div",{style:{width:"100%",display:"flex",justifyContent:"center",margin:"2rem"}},l.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"30rem"}},l.a.createElement("input",{value:o,onChange:e=>c(e.target.value),style:{margin:"1rem 0",padding:"1rem"},name:"title",placeholder:"Insert title",type:"text"}),l.a.createElement("input",{value:i,onChange:e=>u(e.target.value),style:{margin:"1rem 0",padding:"1rem"},name:"price",placeholder:"Insert price",type:"number"}),l.a.createElement("input",{value:d,onChange:e=>g(e.target.value),style:{margin:"1rem 0",padding:"1rem"},type:"number",name:"quantity",placeholder:"Insert quantity"}),l.a.createElement("button",{disabled:v(),onClick:async()=>{try{const e=await m("POST",p,{id:E.id,title:o,price:i,quantity:d});console.log(e)}catch(e){console.log(e),t(e.message)}finally{r(!1)}},style:{opacity:v()?.8:null,margin:"1rem",padding:"1rem"}},"Add product")))},f=a(7),O=a(14);const j=Object(O.b)({name:"auth",initialState:{user:JSON.parse(localStorage.getItem("scampoUser"))?JSON.parse(localStorage.getItem("scampoUser")):null},reducers:{login:(e,t)=>{var a,n,l;console.log(t.payload),localStorage.setItem("scampoUser",JSON.stringify({token:null===(a=t.payload)||void 0===a?void 0:a.token,email:null===(n=t.payload)||void 0===n?void 0:n.email,username:null===(l=t.payload)||void 0===l?void 0:l.username})),e.user=t.payload},logout:e=>{e.user=null,localStorage.removeItem("scampoUser")}}}),{login:S,logout:w}=j.actions;var C=j.reducer;var x=()=>{const e=Object(f.c)(e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.user}),[t,a]=Object(n.useState)(!1),[r,o]=Object(n.useState)(!1),[c,i]=Object(n.useState)(""),[u,d]=Object(n.useState)(""),[p,g]=Object(n.useState)(""),[y,v]=Object(n.useState)(""),h=Object(s.r)(),b=Object(f.b)();return e?l.a.createElement(s.a,{to:"/",replace:!0}):l.a.createElement("div",{style:{width:"100vw",height:"100vh",display:"flex",justifyItems:"center",justifyContent:"center",margin:"2rem"}},r||t?null:l.a.createElement(l.a.Fragment,null,l.a.createElement("button",{onClick:()=>o(!0)},"SIGNIN"),l.a.createElement("button",{onClick:()=>a(!0)},"LOGIN")),t?l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"30rem"}},l.a.createElement("input",{onChange:e=>d(e.target.value),style:{margin:"1rem 0",padding:"1rem"},name:"email-username",placeholder:"Insert email or username",type:"text"}),l.a.createElement("input",{onChange:e=>g(e.target.value),style:{margin:"1rem 0",padding:"1rem"},name:"password",placeholder:"Insert password",type:"number"}),l.a.createElement("button",{onClick:async()=>{try{const e=await m("POST",E.login,{email:u,password:p});b(S(e)),h("/products",{replace:!0})}catch(e){console.log(e)}}},"Login"))):r?l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"30rem"}},l.a.createElement("input",{onChange:e=>i(e.target.value),style:{margin:"1rem 0",padding:"1rem"},name:"username",placeholder:"Insert username",type:"text"}),l.a.createElement("input",{onChange:e=>d(e.target.value),style:{margin:"1rem 0",padding:"1rem"},name:"email",placeholder:"Insert email",type:"text"}),l.a.createElement("input",{onChange:e=>g(e.target.value),style:{margin:"1rem 0",padding:"1rem"},type:"text",name:"password",placeholder:"Insert password"}),l.a.createElement("input",{onChange:e=>v(e.target.value),style:{margin:"1rem 0",padding:"1rem"},type:"text",name:"password",placeholder:"Confirm password"}),l.a.createElement("button",{onClick:async()=>{try{const e=await m("POST",E.signIn,{username:c,email:u,password:p,confirmedPassword:y});console.log(e)}catch(e){console.log(e)}}},"Signin"))):null)};var I=()=>l.a.createElement("div",null,"NoMatch");var T=()=>{var e,t;const a=Object(f.c)(e=>e.user),n=Object(f.b)();return l.a.createElement("nav",{style:{widht:"100%",display:"flex",alignItems:"center",justifyContent:"justify-between",padding:"1rem"}},l.a.createElement("div",{style:{flex:3,display:"flex",alignItems:"center",justifyContent:"justify-between"}},a?l.a.createElement(l.a.Fragment,null,l.a.createElement("button",{style:{textDecoration:"none",color:"#000",marginRight:"1rem"},to:"/auth",onClick:async()=>{try{await m("GET",E.logout)&&n(w())}catch(e){console.log(e)}}},"Logout"),l.a.createElement("button",null,l.a.createElement(c.b,{style:{textDecoration:"none",color:"#000",marginRight:"1rem"},to:"/add-product"},"New product"))):l.a.createElement("button",null,l.a.createElement(c.b,{style:{textDecoration:"none",color:"#000",marginRight:"1rem"},to:"/auth"},"Auth")),l.a.createElement("button",null,l.a.createElement(c.b,{style:{textDecoration:"none",color:"#000",marginRight:"1rem"},to:"/products"},"See products")),l.a.createElement("button",null,l.a.createElement(c.b,{style:{textDecoration:"none",color:"#000",marginRight:"1rem"},to:"/"},"Home"))),a?l.a.createElement("div",{style:{flex:1,textTransform:"capitalize",display:"flex",justifyContent:"flex-end"}},l.a.createElement("p",null,"User: ",null===(e=a.user)||void 0===e||null===(t=e.username)||void 0===t?void 0:t.replace("."," "))):null)};const k=()=>Object(f.c)(e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.user})?l.a.createElement(l.a.Fragment,null,l.a.createElement(T,null),l.a.createElement(s.b,null)):l.a.createElement(s.a,{to:"/auth",replace:!0});var D=()=>l.a.createElement("div",{style:{width:"100vw",height:"100vh",display:"flex",justifyContent:"center",alignItems:"center"}},"Welcome to scampoleria app");var N=()=>l.a.createElement("div",{className:"App"},l.a.createElement(c.a,{basename:"/scampoleria"},l.a.createElement(s.e,null,l.a.createElement(s.c,{path:"/auth",element:l.a.createElement(x,null)}),l.a.createElement(s.c,{element:l.a.createElement(k,null)},l.a.createElement(s.c,{path:"/",element:l.a.createElement(D,null)}),l.a.createElement(s.c,{path:"/add-product",element:l.a.createElement(v,null)}),l.a.createElement(s.c,{path:"/products",element:l.a.createElement(h,null)}),l.a.createElement(s.c,{path:"/edit-product/:id",element:l.a.createElement(b,null)})),l.a.createElement(s.c,{path:"*",element:l.a.createElement(I,null)})))),P=Object(O.a)({reducer:{user:C}});const U=document.getElementById("root");o.a.createRoot(U).render(l.a.createElement(f.a,{store:P},l.a.createElement(N,null))),Object({NODE_ENV:"production",PUBLIC_URL:"/scampoleria",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).CI=!1}},[[21,1,2]]]);
//# sourceMappingURL=main.dd296e80.chunk.js.map